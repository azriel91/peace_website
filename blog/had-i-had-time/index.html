<!DOCTYPE html>
<html lang="en">

<head>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QVELB8JW90"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-QVELB8JW90');
    </script>
    

    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PF3D48Q9');</script>
    <!-- End Google Tag Manager -->
    

    <meta charset="UTF-8">
    <title>Had I Had Time | Peace - Zero Stress Automation </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <style>
    :root {
        --primary-color: #162741;
        --primary-header-color: #e7faff;
        --primary-text-color: #d7e7f7;
        --primary-text-color-over: #ffffff;
        --primary-link-color: #9b9bab;
        --secondary-color: #08182c;
        --secondary-text-color: #b2b2b7;
        --toc-highlight-text-color: #cceeff;
        --toc-background-color: #242d3e;
        --code-color: white;
        --code-background-color: #04091c;

        --shadow-color: #091823;
    }

    @media (prefers-color-scheme: light) {
        :root {
            --primary-color: #a8c5dd;
            --primary-header-color: #041437;
            --primary-text-color: #082837;
            --primary-text-color-over: #4488b9;
            --primary-link-color: #5b5b7b;
            --secondary-color: #e9f7ff;
            --secondary-text-color: #606080;
            --toc-highlight-text-color: #2255aa;
            --toc-background-color: white;
            --code-color: white;
            --code-background-color: #04091c;

            --shadow-color: #c9d7eb;
        }
    }
</style>

    <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,500,600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="https://peace.mk/hush.css">
    <link rel="stylesheet" href="https://peace.mk/breadcrumb.css">
    
<link rel="stylesheet" href="https://peace.mk/blog_post.css">

</head>

<body>
    
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-QVELB8JW90"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    

    
    <header class="box-shadow">
        

<a href="https://peace.mk/">
    <div class="logo">
        <img src="https://peace.mk/img/dove.svg" alt="logo">
        Peace
    </div>
</a>


<div class="breadcrumb">
    
    
        
        
            
            
        

        
        <div class="breadcrumb_tab">
            <div class="breadcrumb_link_wrapper">
                <a class="breadcrumb_link breadcrumb_link_main " href="https://peace.mk/blog/">ü™∂ Blog</a>
            </div>

            
            <div class="breadcrumb_tab_end_wrapper">
                <div class="breadcrumb_tab_end breadcrumb_tab_end_top"></div>
                <div class="breadcrumb_tab_end breadcrumb_tab_end_bottom"></div>
            </div>
        </div>
    

    

    
    
        <div class="breadcrumb_tab">
            <div class="breadcrumb_link_wrapper">
                <a class="breadcrumb_link breadcrumb_link_sub" href="https://peace.mk/blog/had-i-had-time/">Had I Had Time</a>
            </div>
        </div>
    
</div>




<nav>
    
    
    <a class="nav-item subtitle-text" href="https://peace.mk/milestones/">ü™® Milestones</a>
    
    

    
    
    <a class="nav-item subtitle-text" href="https://peace.mk/blog/">ü™∂ Blog</a>
    

    
        
        <a class="nav-item subtitle-text" href="https://discord.gg/R6HcASbYAj" target="_blank">Discord</a>
        
        <a class="nav-item subtitle-text" href="https://github.com/azriel91/peace" target="_blank">Github</a>
        
        <a class="nav-item subtitle-text" href="/book/introduction.html" target="_blank">Book</a>
        
    
</nav>

    </header>

    
    

    

    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#so-far">So Far</a>
                </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#for-users"><small>- For Users</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#for-developers"><small>- For Developers</small></a>
                </div>
                
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#up-ahead">Up Ahead</a>
                </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#production-readiness"><small>- Production Readiness</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#user-interface"><small>- User Interface</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://peace.mk/blog/had-i-had-time/#api-refinement"><small>- API Refinement</small></a>
                </div>
                
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<div class="heading-text">‚è≤Ô∏è Had I Had Time</div>

<div id="post-info">
    <div class="date">
        <span id="publish">2023-06-29</span>
        </div>
    <div class="tags">
        <span class="tag"><span>concepts</span></span>
    </div>
</div>

<blockquote>
<p>Had I had time, what would perfect automation look like?</p>
</blockquote>
<h1 id="so-far"><a class="zola-anchor" href="#so-far" aria-label="Anchor link for: so-far">So Far</a></h1>
<h2 id="for-users"><a class="zola-anchor" href="#for-users" aria-label="Anchor link for: for-users">For Users</a></h2>
<p>From the book of "don't overwhelm me while I'm learning" (or, <em>ever</em>), the user experience has been refined to be understandable and safe.</p>
<h3 id="solid-foundations"><a class="zola-anchor" href="#solid-foundations" aria-label="Anchor link for: solid-foundations">Solid Foundations</a></h3>
<p>Automation software built using the Peace framework allows users to:</p>
<ul>
<li>See what would happen, <em>before</em> making it happen.</li>
<li>Press "go" multiple times, without adverse effects.</li>
</ul>
<p><video controls width="100%"><source src="envman_basic_demo.mp4" type="video/mp4" /></video></p>
<h3 id="changes-of-mind"><a class="zola-anchor" href="#changes-of-mind" aria-label="Anchor link for: changes-of-mind">Changes Of Mind</a></h3>
<p>There is some resilience to changes of mind and interruptions, and <em>you are not punished for changing your mind</em>:</p>
<p><video controls width="100%"><source src="envman_interruption_demo.mp4" type="video/mp4" /></video></p>
<p><sub>‚ÑπÔ∏è Also, that state discovery step after interruption won't be necessary when <a href="https://github.com/azriel91/peace/issues/141">peace#141</a> is implemented</sub></p>
<h3 id="profile-support"><a class="zola-anchor" href="#profile-support" aria-label="Anchor link for: profile-support">Profile Support</a></h3>
<p>Peace is designed to support for working with multiple environments; though this part is still early days:</p>
<p><video controls width="100%"><source src="envman_profile_demo.mp4" type="video/mp4" /></video></p>
<h2 id="for-developers"><a class="zola-anchor" href="#for-developers" aria-label="Anchor link for: for-developers">For Developers</a></h2>
<h3 id="write-code-not-strings"><a class="zola-anchor" href="#write-code-not-strings" aria-label="Anchor link for: write-code-not-strings">Write Code, Not Strings</a></h3>
<p>Type safety, compile time support, and code assist enables:</p>
<ul>
<li>Easy discovery of what parameters are available ‚Äì no more searching and pasting large chunks of YAML / JSON.</li>
<li>Errors at compile time ‚Äì no longer waste time deploying to discover <em>minor</em> issues.</li>
<li>Writing code to pass values between items, not string templates.</li>
</ul>
<p>Real code from <a href="https://github.com/azriel91/peace/blob/0.0.11/examples/envman/src/flows/env_deploy_flow.rs#L134-L148"><code>env_deploy_flow.rs@0.0.11</code></a>:</p>
<pre data-lang="rust" style="background-color:#04091c;color:#eaeaea;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#c397d8;">let</span><span> iam_role_params_spec = IamRoleParams::&lt;WebApp&gt;::field_wise_spec()
</span><span>    .</span><span style="color:#70c0b1;">with_name</span><span>(iam_role_name)
</span><span>    .</span><span style="color:#70c0b1;">with_path</span><span>(path.</span><span style="color:#70c0b1;">clone</span><span>())
</span><span>    .</span><span style="color:#70c0b1;">with_managed_policy_arn_from_map</span><span>(|</span><span style="color:#d54e53;">iam_policy_state</span><span>: &amp;IamPolicyState| {
</span><span>        </span><span style="color:#c397d8;">if let </span><span>IamPolicyState::Some {
</span><span>            policy_id_arn_version: Generated::Value(policy_id_arn_version),
</span><span>            ..
</span><span>        } = iam_policy_state
</span><span>        {
</span><span>            Some(policy_id_arn_version.</span><span style="color:#70c0b1;">arn</span><span>().</span><span style="color:#70c0b1;">to_string</span><span>())
</span><span>        } </span><span style="color:#c397d8;">else </span><span>{
</span><span>            None
</span><span>        }
</span><span>    })
</span><span>    .</span><span style="color:#70c0b1;">build</span><span>();
</span></code></pre>
<h3 id="no-minor-annoyances"><a class="zola-anchor" href="#no-minor-annoyances" aria-label="Anchor link for: no-minor-annoyances">No Minor Annoyances</a></h3>
<p>The little things are taken care of:</p>
<ul>
<li>Sorted values for clear and understandable diffs.</li>
<li>Sensible directory structure for separate and common values within a namespace.</li>
</ul>
<pre data-lang="diff" style="background-color:#04091c;color:#eaeaea;" class="language-diff "><code class="language-diff" data-lang="diff"><span>‚ùØ diff -u .peace/envman/demo_1/env_deploy/{states_goal.yaml,states_current.yaml}
</span><span> iam_role: !Some
</span><span>   name: demo_1
</span><span>   path: /
</span><span style="color:#d54e53;">-  role_id_and_arn: !Tbd null
</span><span style="color:#b9ca4a;">+  role_id_and_arn: !Value
</span><span style="color:#b9ca4a;">+    id: AROASBLNZJUXOTGGPP7PX
</span><span style="color:#b9ca4a;">+    arn: arn:aws:iam::140353555758:role/demo_1
</span><span>   ..
</span></code></pre>
<pre style="background-color:#04091c;color:#eaeaea;"><code><span>repo/.peace/envman/demo_1/env_deploy
</span><span>     ^      ^      ^      ^
</span><span>     |      |      |      &#39;--------- flow: cleanly separate information for different
</span><span>     |      |      |                 workflows, e.g. &quot;deploy&quot; vs &quot;load data&quot;
</span><span>     |      |      |
</span><span>     |      |      &#39;----- profile: logically separates environments
</span><span>     |      |
</span><span>     |      &#39;----- tool name: allows multiple tools to be run in the same repo
</span><span>     |
</span><span>     &#39;----- `.peace` data directory, like `.git`
</span></code></pre>
<p><em>Take care of the little things, that make the little difference, that make the big difference.</em></p>
<h1 id="up-ahead"><a class="zola-anchor" href="#up-ahead" aria-label="Anchor link for: up-ahead">Up Ahead</a></h1>
<p>There are three dimensions that I'd like to develop Peace further:</p>
<h2 id="production-readiness"><a class="zola-anchor" href="#production-readiness" aria-label="Anchor link for: production-readiness">Production Readiness</a></h2>
<div id="production_readiness_dot"></div>
<p>The lifetime of an environment should be able to exist before, and live beyond, a version of the automation software that manages it.</p>
<p>For the Peace framework to be a sensible choice to build a production tool, the framework and items must be able to handle evolving data and logic. Namely, handling cases like:</p>
<ul>
<li>Terminate these servers, recreate the VPC with resized CIDR blocks, then launch new servers in the new VPC.</li>
<li>This infrastructure was created manually, now it should be automatically managed, and migrated to use new naming conventions.</li>
</ul>
<p>The <a href="https://github.com/users/azriel91/projects/1">Peace: Production Readiness</a> GitHub project captures this work. See <a href="https://peace.mk/book/technical_concepts/flow_versioning.html">Flow Versioning</a> for my technical thinking out loud notes.</p>
<h2 id="user-interface"><a class="zola-anchor" href="#user-interface" aria-label="Anchor link for: user-interface">User Interface</a></h2>
<div id="user_interface_dot"></div>
<p>Two common methods to access automation are the command line, and the web browser.</p>
<p>Peace should provide support for:</p>
<ul>
<li>Invoking commands to interact with the environment.</li>
<li>Presenting common data ‚Äì usually <code>States</code>, but also <code>ParamsSpecs</code>, <code>Params</code>, errors, and progress.</li>
</ul>
<p>Some of the CLI presentation logic currently lives in the <code>envman</code> example, and should be moved into <code>peace</code>, and the web presentation logic is currently "bundle <a href="https://github.com/leptos-rs/leptos"><code>leptos</code></a> with the command line app and render the flow graph".</p>
<p>The <a href="https://github.com/users/azriel91/projects/2">Peace: UI</a> GitHub project captures the start of this work. For the web UI part, see <a href="https://github.com/azriel91/peace/blob/0.0.11/DEVELOPMENT.md#web-development"><code>DEVELOPMENT.md#web-development</code></a>.</p>
<h2 id="api-refinement"><a class="zola-anchor" href="#api-refinement" aria-label="Anchor link for: api-refinement">API Refinement</a></h2>
<div id="api_refinement_dot"></div>
<p>There is some API that doesn't prevent developers from making mistakes or having mild annoyances through natural usage of the API.</p>
<p>The API should be refined to avoid setting up such situations, and implement additional functionality that makes it easier to work with information across profiles or across flows.</p>
<p>The <a href="https://github.com/users/azriel91/projects/3">Peace: API Refinement and Features</a> GitHub project captures this work.</p>
<hr />
<p>Had I had time, developing these would be excellent.</p>
<p>But I don't ‚Äì I'm off to work!<br />
üèÉüèΩ‚Äç‚ôÇÔ∏èüí®</p>
<script type="text/javascript">
// Hack to set the playback rate for videos.
// You can't set it in the HTML element.
document.querySelectorAll("video").forEach(v => { v.playbackRate = 2.0; });
</script>
<script type="module">
    import { Graphviz } from "https://cdn.jsdelivr.net/npm/@hpcc-js/wasm/dist/graphviz.js";

    const graphviz = await Graphviz.load();
    const production_readiness_dot = `digraph G {
        graph [
            penwidth  = 0
            nodesep   = 0.1
            ranksep   = 0.3
            bgcolor   = "transparent"
            fontname  = "helvetica"
            fontsize  = 12
            fontcolor = "#9f9f9f"
            splines   = line
            rankdir   = LR
        ]
        node [
            penwidth  = 4
            fontcolor = "#111111"
            fontname  = "monospace"
            fontsize  = 9
            shape     = "circle"
            style     = "filled"
            width     = 0.25
            height    = 0.25
            margin    = 0.04
            color     = "#9999aa"
            fillcolor = "#ddddf5"
        ]
        edge [
            penwidth  = 1
            arrowsize = 0.5
            color     = "#7f7f7f"
            fontcolor = "#7f7f7f"
        ]

        subgraph cluster_env_v1 {
            label = "env_v1"
            labelloc = "bottom"

            env_v1_a [label = ""]
            env_v1_b [label = ""]
            env_v1_c [label = ""]
            env_v1_d [label = ""]
            env_v1_e [label = "", style = "invis"]

            env_v1_a -> env_v1_b
            env_v1_a -> env_v1_c
            env_v1_b -> env_v1_d
            env_v1_b -> env_v1_e [style = "invis"]
            env_v1_c -> env_v1_e [style = "invis"]
        }

        subgraph cluster_env_v2 {
            label = "env_v2"
            labelloc = "bottom"

            env_v2_a [label = ""]
            env_v2_b [label = ""]
            env_v2_c [label = ""]
            env_v2_d [label = ""]
            env_v2_e [label = "", color="#449966", fillcolor="#88cc88"]

            env_v2_a -> env_v2_b
            env_v2_a -> env_v2_c
            env_v2_b -> env_v2_d
            env_v2_b -> env_v2_e
            env_v2_c -> env_v2_e
        }

        subgraph cluster_env_v3 {
            label = "env_v3"
            labelloc = "bottom"

            env_v3_a [label = ""]
            env_v3_b [label = "", color="#994444", fillcolor="#cc8888"]
            env_v3_c [label = ""]
            env_v3_d [label = "", color="#994444", fillcolor="#88cc88", style="dashed,filled"]
            env_v3_e [label = "", color="#994444", fillcolor="#88cc88", style="dashed,filled"]

            env_v3_a -> env_v3_b
            env_v3_a -> env_v3_c
            env_v3_b -> env_v3_d
            env_v3_b -> env_v3_e
            env_v3_c -> env_v3_e
        }

        env_v1_d -> env_v2_a [style = "invis"]
        env_v1_e -> env_v2_a [style = "invis"]

        env_v2_d -> env_v3_a [style = "invis"]
        env_v2_e -> env_v3_a [style = "invis"]
    }`;
    document.getElementById("production_readiness_dot").innerHTML = graphviz.layout(production_readiness_dot, "svg", "dot");

    const user_interface_dot = `digraph G {
        graph [
            margin    = 0.0
            penwidth  = 0
            nodesep   = 0.0
            ranksep   = 0.02
            bgcolor   = "transparent"
            fontname  = "helvetica"
            fontcolor = "#7f7f7f"
            rankdir   = LR
            splines   = line
        ]
        node [
            fontcolor = "#111111"
            fontname  = "monospace"
            fontsize  = 12
            shape     = "circle"
            style     = "filled"
            width     = 0.3
            height    = 0.3
            margin    = 0.04
            color     = "#9999aa"
            fillcolor = "#ddddf5"
            penwidth  = 3
        ]
        edge [
            arrowsize = 0.7
            color     = "#7f7f7f"
            fontcolor = "#7f7f7f"
            penwidth  = 3
        ]

        subgraph cluster_a {
            node [color="#449966" fillcolor="#99dd99"]
            a [label = <<b>a</b>>]
            a_text [shape="plain" style="" fontcolor="#7f7f7f" label = <<table border="0" cellborder="0" cellpadding="0"><tr>
                <td><font point-size="15">üì•</font></td>
                <td balign="left">file<br/>download</td>
            </tr></table>>]
        }

        subgraph cluster_b {
            node [color="#446699" fillcolor="#99aaee"]
            b [label = <<b>b</b>> class="item_b_in_progress" style="dashed,filled"]
            b_text [shape="plain" style="" fontcolor="#7f7f7f" label = <<table border="0" cellborder="0" cellpadding="0"><tr>
                <td><font point-size="15">ü™£</font></td>
                <td balign="left">s3<br/>bucket</td>
            </tr></table>>]
        }

        subgraph cluster_c {
            c [label = <<b>c</b>>]
            c_text [shape="plain" style="" fontcolor="#7f7f7f" label = <<table border="0" cellborder="0" cellpadding="0"><tr>
                <td><font point-size="15">üì§</font></td>
                <td balign="left">s3<br/>object</td>
            </tr></table>>]
        }

        a -> c [minlen = 9, color="#66aa66"]
        b -> c [minlen = 9, color="#6688bb"]
    }`;
    document.getElementById("user_interface_dot").innerHTML = graphviz.layout(user_interface_dot, "svg", "dot");
</script>
<style type="text/css">
.item_b_in_progress ellipse {
    animation: 10.0s linear forwards 0.0s infinite item_b_in_progress;
}
@keyframes item_b_in_progress {
    0% {
        transform-origin: 42.16px -56px;
/*        transform-origin: attr(cx px) attr(cy px);*/
        transform: rotate(0deg);
    }
    100% {
        transform-origin: 42.16px -56px;
/*        transform-origin: attr(cx px) attr(cy px);*/
        transform: rotate(360deg);
    }
}
</style>


<div class="post_nav">

<a class="post_nav_button" href="https:&#x2F;&#x2F;peace.mk&#x2F;blog&#x2F;conceptual-introduction&#x2F;">&lt; Prev</a>


<!-- Empty spacer -->
<div></div>


<a class="post_nav_button" href="https:&#x2F;&#x2F;peace.mk&#x2F;blog&#x2F;checkpoint&#x2F;">Next &gt;</a>

</div>


        </div>

        <!-- For spacing -->
        
        <div class="sidebar"></div>
        
    </main>

    
    <footer>
        <small class="subtext">
            made with <a href="https://github.com/azriel91/hush">ü™∂ hush</a> ¬© 2025
        </small>
    </footer>
    
</body>

<script>
    const scrollHandler = entries => {
        // Find the first entry which intersecting and ratio > 0.9 to highlight.
        let entry = entries.find(entry => {
            return entry.isIntersecting && entry.intersectionRatio > 0.9;
        });
        if (!entry) return;

        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });

        // let url = new URL(`#${entry.target.id}`);
        let link = document.querySelector(`.toc a[href$="${decodeURIComponent(`#${entry.target.id}`)}"]`)
        if (link) {
            link.classList.add("active");
            link.scrollIntoView({ behavior: "auto", block: "nearest" });
        }
    };
    // Set -100px root margin to improve highlight experience.
    const observer = new IntersectionObserver(scrollHandler, { threshold: 1 });
    let items = document.querySelectorAll('h1,h2,h3,h4,h5,h6');
    items.forEach(item => observer.observe(item));
</script>

</html>
